!! History  !!
! 11/14/2019 TESSA Beamline (Spectrometer beamline still in progress).
! 08/10/2018 Added pre-buncher and matched Twiss functions (without bunching chicane *)
! 07/23/2018 added TESSA chicane producing ~ 1 cm orbit offset and re-matched lattice 
!            at the prebuncher entrance obtaining betx=3.896409e+00, alphax=-8.134967e-01, bety=3.236882e+00, alphay=1.239235e+00 
! 11/17/2016 changed DUTT: drift,l=0.20 
! Comment and uncomment quadrupole settings depending on lattice configurations,
! i.e., quadrupoles for betax=betay=0.2m at the IP or quadrupoles 
! for betax=0.2m and betay=4m at the IP
! 12/07/2016 switched LE:Q7 to LE:Q1, but quadrupole center is same. Updated LEA quadrupoles
! 12/19/2016 made the length for all YAGs, BPMs, DCCT equal to 0.01 m and kept location of centers unchanged
! 12/20/2016 re-named all drift spaces in LEA beamline
! 01/16/2017 corrected several drif spaces agian to obtain agreement with Autocad drawing
! 05/09/2017 CSR effect for chicane and vertical bending in bypass beamline. You can find CSR part by searching "CSR" 
! 05/09/2017 Update Quadrupole set value for new spectrometer  
! 05/09/2017 Wakefield implementation in DUT (Type 1 is considered.)
! 05/10/2017 Vertical deflecting cavity was implemented. 
! 05/11/2017 Mark "SpecM" was added before spectrometer bending magnet for matching condition with large (40 m) 
!            vertical beta function at bending magent for improved energy resolution. 
!             

INITTWISS: twiss
TUBE: MAXAMP,X_MAX=0.01905,Y_MAX=0.01905,ELLIPTICAL=1
NTUBE: MAXAMP,X_MAX=0,Y_MAX=0
RG2SC1: LSCDRIFT,LSC=1,BINS=1024, L= 0.037                      !best estimate
"L1:RG2:SC1V": VKICK
"L1:RG2:SC1H": HKICK
RG2SC1QM1: LSCDRIFT,LSC=1,BINS=1024, L=0.0363575
"L1:RG2:QM1": QUAD, L="0.03865 2 *",K1=6.34928620177195      !per jl-original
L1RG2QM1M: mark,fitpoint=1
RG2QM1SC2: LSCDRIFT,LSC=1,BINS=1024, L=0.0677632
"L1:RG2:SC2V": VKICK
"L1:RG2:SC2H":  HKICK
RG2SC2QM2: LSCDRIFT,LSC=1,BINS=1024, L=0.067632
L1RG2QM2M: mark,fitpoint=1
"L1:RG2:QM2": QUAD, L="0.03865 2 *",K1=-13.2509272525745      !per jl
RG2QM2KIK: LSCDRIFT,LSC=1,BINS=1024, L=0.0466410
"L1:RG2:KIK": KICKER, L=0.112 
RG2KIKQM3: LSCDRIFT,LSC=1,BINS=1024, L=0.0466410
L1RG2QM3M: mark,fitpoint=1
"L1:RG2:QM3": QUAD, L="0.03865 2 *",K1=17.8311515098387       !per jl
RG2QM3QM4: LSCDRIFT,LSC=1,BINS=1024, L=0.124979
L1RG2QM4M: mark,fitpoint=1
"L1:RG2:QM4": QUAD, L="0.03865 2 *",K1=2.57876215044452
RG2QM4SC3: LSCDRIFT,LSC=1,BINS=1024, L=0.0158528
"L1:RG2:SC3V": VKICK
"L1:RG2:SC3H": HKICK
RG2SC3AL2: LSCDRIFT,LSC=1,BINS=1024, L=0.157746

"L1:RG2:LFA": ALPH,XMAX=.1206,ORDER=3

RG2PFIL: PFILTER,lowerfraction=0.4,upperfraction=0
RG2TOALF2: LINE=(RG2PFIL,TUBE,RG2SC1,L1:RG2:SC1V,L1:RG2:SC1H,RG2SC1QM1,L1:RG2:QM1,L1RG2QM1M,RG2QM1SC2,&
       L1:RG2:SC2V,L1:RG2:SC2H,RG2SC2QM2,L1:RG2:QM2,L1RG2QM2M,RG2QM2KIK,L1:RG2:KIK,RG2KIKQM3,&
       L1:RG2:QM3,L1RG2QM3M,RG2QM3QM4,L1:RG2:QM4,L1RG2QM4M,RG2QM4SC3,L1:RG2:SC3V,L1:RG2:SC3H,RG2SC3AL2,NTUBE)

BYPL1: LSCDRIFT,LSC=1,BINS=1024,L=0.68649225
BYPL2: LSCDRIFT,LSC=1,BINS=1024,L=0.494819500000905
BYPL2A: LSCDRIFT,LSC=1,BINS=1024,L=0.6727880000000001
BYPL3: LSCDRIFT,LSC=1,BINS=1024,L=1.2
BYPL4: LSCDRIFT,LSC=1,BINS=1024,L=1.2
BYPL5: LSCDRIFT,LSC=1,BINS=1024,L=0.45422
BYPL6: LSCDRIFT,LSC=1,BINS=1024,L=1.136503
BYPL7: LSCDRIFT,LSC=1,BINS=1024,L=0.704624
BYPLV1: LSCDRIFT,LSC=1,BINS=1024,L=0.200669344171
"PB:Q1": QUAD,L=0.1527,K1=-2.50799213997271
"PB:Q2": QUAD,L=0.1527,K1=2.566053168389025
"PB:Q3": QUAD,L=0.1527,K1=3.819057464372259
"PB:Q4": QUAD,L=0.1527,K1=-4.415121671676806
DDL1: LSCDRIFT,LSC=1,BINS=1024,L=0.1321
DDL2: LSCDRIFT,LSC=1,BINS=1024,L=0.2
DDPO: WATCH,FILENAME="%s.ddin",LABEL="",MODE="coord"
L1AL1SC1: LSCDRIFT,LSC=1,BINS=1024,L=0.291866000000000
L1AL2SC3: LSCDRIFT,LSC=1,BINS=1024,L=0.177057
L1AS1AL1: LSCDRIFT,LSC=1,BINS=1024,L=0.5816170000000001
"L1:PM1": MONI
"LI:FL:FS1": mark
"LI:FL:FS4": mark
"LI:FL:FS5": mark
"LI:FL:FS6": mark
"LI:FL:FS7": mark
"LI:FL:FS8": mark
"LI:FL:FS9": mark
L1DSF: MARK
L1L: LSCDRIFT,LSC=1,BINS=1024,L=0.04916
L1Q1Q2: LSCDRIFT,LSC=1,BINS=1024,L=0.110743
L1Q2SC2: LSCDRIFT,LSC=1,BINS=1024,L=0.06694799999999999
L1Q3Q4: LSCDRIFT,LSC=1,BINS=1024,L=0.105001
L1Q4Q5H1: LSCDRIFT,LSC=1,BINS=1024,L=0.114343
L1Q4Q5H2: LSCDRIFT,LSC=1,BINS=1024,L=0.070963
L1Q5SC4: LSCDRIFT,LSC=1,BINS=1024,L=0.074894
"L1:QM1": QUAD,L=0.07729999999999999,K1=12.06467051192251
"L1:QM2": QUAD,L=0.07729999999999999,K1=-14.9139467619181
"L1:QM3": QUAD,L=0.07729999999999999,K1=6.120719388720973
"L1:QM4": QUAD,L=0.07729999999999999,K1=-10.50338652626355
"L1:QM5": QUAD,L=0.07729999999999999,K1=8.487485149194491
"L1:SC1": KICKER
L1SC1Q1: LSCDRIFT,LSC=1,BINS=1024,L=0.067715
L1SC2AL2: LSCDRIFT,LSC=1,BINS=1024,L=0.660128
"L1:SC2": KICKER
"L1:SC3": KICKER
L1SC3Q3: LSCDRIFT,LSC=1,BINS=1024,L=0.114423
"L1:SC4":KICKER
L1SC4L: LSCDRIFT,LSC=1,BINS=1024,L=0.093121
LIFS1L: LSCDRIFT,LSC=1,BINS=1024,L="0.411603 0.093121 -"
"L2:QM1": QUAD,L=1e-10,K1=-245100372.5829097
"L2:QM1M": MARK,FITPOINT=1
"L2:QM2": QUAD,L=1e-10,K1=133028401.6516908
"L2:QM2M": MARK,FITPOINT=1
"L2:QM3": QUAD,L=1e-10,K1=-244371637.2418276
"L2:QM3M": MARK,FITPOINT=1
"L2:QM4": QUAD,L=1e-10,K1=221657617.2101344
"L2:QM4M": MARK,FITPOINT=1
"L2:QM5": QUAD,L=1e-10,K1=-280604048.3329294
"L2:QM5M": MARK,FITPOINT=1
"L2:QM6": QUAD,L=1e-10,K1=320273476.4729607
"L2:QM6M": MARK,FITPOINT=1
"L2:QM7": QUAD,L=1e-10,K1=-1017484675.671409
"L2:QM7M": MARK,FITPOINT=1
"L2:QM8": QUAD,L=1e-10,K1=1028984613.260913
"L2:QM8M": MARK,FITPOINT=1
"L2:SC1": KICKER
"LI:FL:S1C1": mark
"LI:FL:S1C2": mark
"L2:SC2": KICKER
"L2:SC3": KICKER
"L2:SC4": KICKER
L2AS12A: LSCDRIFT,LSC=1,BINS=1024,L=0.310490333333333
L2SC1L: LSCDRIFT,LSC=1,BINS=1024,L=0.382862
LIS1C1L: LSCDRIFT,LSC=1,BINS=1024,L="0.535620666333333 0.382862 -"
L2PM1L: LSCDRIFT,LSC=1,BINS=1024,L=0.1647410000000
LIS1C2L: LSCDRIFT,LSC=1,BINS=1024,L="0.340622998433333 0.1647410000000 -"
"L2:PM1": MONI
"L2:PM2": MONI
"L2:PM3": MONI
L2AS1M: MARK
L2AS1BEG: MARK
L2AS1END: MARK
L2AS23A: LSCDRIFT,LSC=1,BINS=1024,L=0.126657665666667
L2AS23B: LSCDRIFT,LSC=1,BINS=1024,L=0.666693665666667
L2AS23C: LSCDRIFT,LSC=1,BINS=1024,L=0.396113666866667
L2AS2M: MARK
L2AS2BEG: MARK
L2AS2END: MARK
L2AS34A: LSCDRIFT,LSC=1,BINS=1024,L=0.130064
L2AS34B: LSCDRIFT,LSC=1,BINS=1024,L=0.239869
L2AS34C: LSCDRIFT,LSC=1,BINS=1024,L=0.8180809982
L2AS3M: MARK
L2AS3BEG: MARK
L2AS3END: MARK
L2AS4L1: LSCDRIFT,LSC=1,BINS=1024,L=0.060948
L2AS4L2: LSCDRIFT,LSC=1,BINS=1024,L=0.063106
L2AS4M: MARK
L2AS4BEG: MARK
L2AS4END: MARK
L2AS4OF: MARK

L2CELL0: RFCW,LSC=1,CELL_LENGTH=1, L=1, VOLT=9248800
L2CELL1: RFCW,LSC=1,CELL_LENGTH=1,L=0.035,VOLT=323708.1285866122,PHASE=61.06443539271734,&
FREQ=2856000000,CHANGE_P0=1,END1_FOCUS=1,END2_FOCUS=1,N_KICKS=0
L2CELL12: RFCW,LSC=1,CELL_LENGTH=1,L=0.42,VOLT=3884497.543039346,PHASE=61.06443539271734,&
FREQ=2856000000,CHANGE_P0=1,END1_FOCUS=1,END2_FOCUS=1,N_KICKS=0
L2CELL14: RFCW,LSC=1,CELL_LENGTH=1,L=0.49,VOLT=4531913.80021257,PHASE=61.06443539271734,&
FREQ=2856000000,CHANGE_P0=1,END1_FOCUS=1,END2_FOCUS=1,N_KICKS=0
L2CELL16: RFCW,LSC=1,CELL_LENGTH=1,L=0.5600000000000001,VOLT=5179330.057385795,&
PHASE=61.06443539271734,FREQ=2856000000,CHANGE_P0=1,END1_FOCUS=1,END2_FOCUS=1,&
N_KICKS=0
L2CELL2: RFCW,LSC=1,CELL_LENGTH=1,L=0.07000000000000001,VOLT=647416.2571732244,&
PHASE=61.06443539271734,FREQ=2856000000,CHANGE_P0=1,END1_FOCUS=1,END2_FOCUS=1,&
N_KICKS=0
L2CELL4: RFCW,LSC=1,CELL_LENGTH=1,L=0.14,VOLT=1294832.514346449,PHASE=61.06443539271734,&
FREQ=2856000000,CHANGE_P0=1,END1_FOCUS=1,END2_FOCUS=1,N_KICKS=0
L2CELL8: RFCW,LSC=1,CELL_LENGTH=1,L=0.28,VOLT=2589665.028692897,PHASE=61.06443539271734,&
FREQ=2856000000,CHANGE_P0=1,END1_FOCUS=1,END2_FOCUS=1,N_KICKS=0
L2QL: LSCDRIFT,LSC=1,BINS=1024,L=0.076
L2SC4L: LSCDRIFT,LSC=1,BINS=1024,L=0.118541333333333
"L3:FS1": mark
"L3:FS2": mark
"L3:FS3": mark
"L3:FS4": mark
"L3:FS5": mark
"L3:CTR": mark
L3CTRL: drift,l=0.333868
L3FS1L: LSCDRIFT,LSC=1,BINS=1024,L=0.127403333333333

! Original Bend
! 09 May 2017 By S. Shin 
!"L3:BM1": SBEN,L=0.193775965132665,ANGLE=0.234823537033513,E2=0.234823537033513,&
!FINT=0.288,HGAP=0.02,USE_BN=1,B2=6.31
!"L3:BM2": SBEN,L=0.193775965132665,ANGLE=-0.234823537033513,E1=-0.234823537033513,&
!FINT=0.288,HGAP=0.02,USE_BN=1,B2=6.31
!"L3:BM3": SBEN,L=0.192568723939113,ANGLE=-0.133176032408835,E2=-0.133176032408835,&
!FINT=0.288,HGAP=0.02,USE_BN=1,B2=6.31
!"L3:BM4": SBEN,L=0.192568723939113,ANGLE=0.133176032408835,E1=0.133176032408835,&
!FINT=0.288,HGAP=0.02,USE_BN=1,B2=6.31

! CSR bend
! 09 May 2017 By S. Shin
"L3:BM1": csrcsbend,L=0.193775965132665,ANGLE=0.234823537033513,E2=0.234823537033513,&
 nonlinear=1,n_kicks=100,integration_order=4,SLICE_ANALYSIS_INTERVAL=50,&
 bins=500,sg_halfwidth=1,output_file="%s.B1.csr",output_interval=10
"L3:BM2": csrcsbend,L=0.193775965132665,ANGLE=-0.234823537033513,E1=-0.234823537033513,&
nonlinear=1,n_kicks=100,integration_order=4,SLICE_ANALYSIS_INTERVAL=50,&
 bins=500,sg_halfwidth=1,output_file="%s.B2.csr",output_interval=10
"L3:BM3": csrcsbend,L=0.192568723939113,ANGLE=-0.133176032408835,E2=-0.133176032408835,&
nonlinear=1,n_kicks=100,integration_order=4,SLICE_ANALYSIS_INTERVAL=50,&
 bins=500,sg_halfwidth=1,output_file="%s.B3.csr",output_interval=10
"L3:BM4": csrcsbend,L=0.192568723939113,ANGLE=0.133176032408835,E1=0.133176032408835,&
nonlinear=1,n_kicks=100,integration_order=4,SLICE_ANALYSIS_INTERVAL=50,&
 bins=500,sg_halfwidth=1,output_file="%s.B4.csr",output_interval=10

"L3:BM1M": MARK,FITPOINT=1
"L3:BM2M": MARK,FITPOINT=1
"L3:BM3M": MARK,FITPOINT=1
"L3:BM4M": MARK,FITPOINT=1
"L3:PM1": MONI
"L3:PM1M": MARK,FITPOINT=1
"L3:PM2": MONI
"L3:PM3": MONI
"L3:QM1": QUAD,L=0.0776,K1=0.570656512838838
"L3:QM2": QUAD,L=0.0776,K1=-0.988082176103716
"L3:QM2M": MARK,FITPOINT=1
"L3:QM3": QUAD,L=2.245597e-01,K1=-3.5
"L3:QM4": QUAD,L=0.10207,K1=18.89903677417617
"L3:QM5": QUAD,L=0.10207,K1=-23.12860554220556
"L3:QM6": QUAD,L=0.10207,K1=15.42479322925701

! CSR drift
! 09 May 2017 By S. Shin
!

L3FS2L: csrdrift,LSC_BINS=1024,L="0.108075 0.23 2.245597e-01 - 2 / +",dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50
!L3FS2L: LSCDRIFT,LSC=1,BINS=1024,L="0.108075 0.23 2.245597e-01 - 2 / +"

L3FS3L: LSCDRIFT,LSC=1,BINS=1024,L=0.963216000144282
L3FS4L: LSCDRIFT,LSC=1,BINS=1024,L=0.236197902
L3FS5L: LSCDRIFT,LSC=1,BINS=1024,L=0.153313
L3SC2L: LSCDRIFT,LSC=1,BINS=1024,L=0.307238
"L3:SC2":KICKER

L3BM1L: csrdrift,LSC_BINS=1024,L="0.121365622789519 0.076 0.0776 - 2 / +",dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50
L3BM2L: csrdrift,LSC_BINS=1024,L=0.125921,dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50
L3BM3L: csrdrift,LSC_BINS=1024,L="0.990506785653688 0.076 0.0776 - 2 / +",dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50
L3BM4L: csrdrift,LSC_BINS=1024,L=0.159257,dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50

!L3BM1L: LSCDRIFT,LSC=1,BINS=1024,L="0.121365622789519 0.076 0.0776 - 2 / +"
!L3BM2L: LSCDRIFT,LSC=1,BINS=1024,L=0.125921
!L3BM3L: LSCDRIFT,LSC=1,BINS=1024,L="0.990506785653688 0.076 0.0776 - 2 / +"
!L3BM4L: LSCDRIFT,LSC=1,BINS=1024,L=0.159257

L2PM3L: LSCDRIFT,LSC=1,BINS=1024,L=0.251192333333333

L3PM1L: csrdrift,LSC_BINS=1024,L=0.1245,dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50
L3PM2L: csrdrift,LSC_BINS=1024,L=0.085916,dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50
!L3PM1L: LSCDRIFT,LSC=1,BINS=1024,L=0.1245
!L3PM2L: LSCDRIFT,LSC=1,BINS=1024,L=0.085916

L3PM3L: LSCDRIFT,LSC=1,BINS=1024,L=0.085912

L3QM1L: csrdrift,LSC_BINS=1024,L="0.396944985602385 0.076 0.0776 - 2 / +",dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50
L3QM2L: csrdrift,LSC_BINS=1024,L="0.123149946400042 0.076 0.0776 - 2 / +",dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50
L3QM3L: csrdrift,LSC_BINS=1024,L="0.2140696 0.23 2.245597e-01 - 2 / +    0.1 0.10207 - 2 / +",use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50
!L3QM1L: LSCDRIFT,LSC=1,BINS=1024,L="0.396944985602385 0.076 0.0776 - 2 / +"
!L3QM2L: LSCDRIFT,LSC=1,BINS=1024,L="0.123149946400042 0.076 0.0776 - 2 / +"
!L3QM3L: LSCDRIFT,LSC=1,BINS=1024,L="0.2140696 0.23 2.245597e-01 - 2 / +    0.1 0.10207 - 2 / +"

L3QM4L: LSCDRIFT,LSC=1,BINS=1024,L="0.1395218 0.1 0.10207 - 2 / +"
L3SC1L: LSCDRIFT,LSC=1,BINS=1024,L="0.1395478 0.1 0.10207 - 2 / +"
"L3:SC1":KICKER
L3QM5L: LSCDRIFT,LSC=1,BINS=1024,L="0.2790696 0.1 0.10207 - 2 / + 0.1 0.10207 - 2 / + "
L3QM6L: LSCDRIFT,LSC=1,BINS=1024,L="0.1107202 0.1 0.10207 - 2 / +"
L3SC1I: SCRAPER
L3SC1O: SCRAPER
L3SC1PFIL: PFILTER
"L3:SCR": MARK

L3SCR1L: csrdrift,LSC_BINS=1024,l=0.120176,dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50
!L3SCR1L: drift,l=0.120176
L42L5D1: LSCDRIFT,LSC=1,BINS=1024,L=0.079662
L42L5D2: LSCDRIFT,LSC=1,BINS=1024,L=0.218746
L42L5D3: LSCDRIFT,LSC=1,BINS=1024,L=0.2609789991
L4SC1L: drift,l=0.1544062000000

"L4:PM1": MONI
"L4:PM2": MONI
"L4:PM3": MONI
"L4:SC1":KICKER
"L4:SC2":KICKER
"L4:SC3":KICKER
"L4:SC4":KICKER
"L4:SMSC1":KICKER
"L4:SMSC2":KICKER
L4AS12A: LSCDRIFT,LSC=1,BINS=1024,L=0.0908034970000006
LIFS4L: LSCDRIFT,LSC=1,BINS=1024,L=0.315637298999912
L4AS1M: MARK
L4AS1BEG: MARK
L4AS1END: MARK
L4AS23D1: LSCDRIFT,LSC=1,BINS=1024,L=0.1391474993
L4AS23D2: LSCDRIFT,LSC=1,BINS=1024,L=0.078978
L4AS23D3: LSCDRIFT,LSC=1,BINS=1024,L=0.3400034993
L4AS2M: MARK
L4AS2BEG: MARK
L4AS2END: MARK
L4AS34D1: LSCDRIFT,LSC=1,BINS=1024,L=0.122691998
L4AS34D2: LSCDRIFT,LSC=1,BINS=1024,L=0.096517
L4PM2L: LSCDRIFT,LSC=1,BINS=1024,L=0.115761599998606
LIFS5L: LSCDRIFT,LSC=1,BINS=1024,L="0.3384090006 0.115761599998606 -"
L4AS3M: MARK
L4AS3BEG: MARK
L4AS3END: MARK
L4AS4M: MARK
L4AS4BEG: MARK
L4AS4END: MARK
L4CELL1: RFCW,LSC=1,CELL_LENGTH=1,L=0.035,PHASE=96,FREQ=2856000000,CHANGE_P0=1,END1_FOCUS=1,&
END2_FOCUS=1,N_KICKS=0
L4CELL16: RFCW,LSC=1,CELL_LENGTH=1,L=0.5600000000000001,PHASE=96,FREQ=2856000000,CHANGE_P0=1,&
END1_FOCUS=1,END2_FOCUS=1,N_KICKS=0
L4CELL2: RFCW,LSC=1,CELL_LENGTH=1,L=0.07000000000000001,PHASE=96,FREQ=2856000000,CHANGE_P0=1,&
END1_FOCUS=1,END2_FOCUS=1,N_KICKS=0
L4CELL4: RFCW,LSC=1,CELL_LENGTH=1,L=0.14,PHASE=96,FREQ=2856000000,CHANGE_P0=1,END1_FOCUS=1,&
END2_FOCUS=1,N_KICKS=0
L4CELL8: RFCW,LSC=1,CELL_LENGTH=1,L=0.28,PHASE=96,FREQ=2856000000,CHANGE_P0=1,END1_FOCUS=1,&
END2_FOCUS=1,N_KICKS=0
"L5:AM1": LSCDRIFT,LSC=1,BINS=1024,L=0.4875
"L5:PM2": MONI
"L5:PM3": MONI
"L5:PM4": MONI
"L5:SC1":KICKER
"L5:SC2":KICKER
"L5:SC3":KICKER
"L5:SC4":KICKER
L5AS12D1: LSCDRIFT,LSC=1,BINS=1024,L=0.120362
L5SC1L: LSCDRIFT,LSC=1,BINS=1024,L=0.197029199999228
LIFS6L: LSCDRIFT,LSC=1,BINS=1024,L="0.2898049991 0.047030 -"
L5AS1M: MARK
L5AS1BEG: MARK
L5AS1END: MARK
L5AS23D1: LSCDRIFT,LSC=1,BINS=1024,L=0.119134
L5SC2L: LSCDRIFT,LSC=1,BINS=1024,L=0.100034
L5PM2L: LSCDRIFT,LSC=1,BINS=1024,L=0.097560199999400
LIFS7L: LSCDRIFT,LSC=1,BINS=1024,L="0.339800999 0.097560199999400 -"
L5AS2M: MARK
L5AS2BEG: MARK
L5AS2END: MARK
L5AS34D1: LSCDRIFT,LSC=1,BINS=1024,L=0.122103
L5AS34D2: LSCDRIFT,LSC=1,BINS=1024,L=0.10277399999999998
L5PM3L: LSCDRIFT,LSC=1,BINS=1024,L=0.10756380
LIFS8L: LSCDRIFT,LSC=1,BINS=1024,L="0.433712999 0.20756380 -"
L5AS3M: MARK
L5AS3BEG: MARK
L5AS3END: MARK
L5AS4M: MARK
L5AS4BEG: MARK
L5AS4END: MARK
L5CELL1: RFCW,LSC=1,CELL_LENGTH=1,L=0.035,PHASE=96,FREQ=2856000000,CHANGE_P0=1,END1_FOCUS=1,&
END2_FOCUS=1,N_KICKS=0
L5CELL16: RFCW,LSC=1,CELL_LENGTH=1,L=0.5600000000000001,PHASE=96,FREQ=2856000000,CHANGE_P0=1,&
END1_FOCUS=1,END2_FOCUS=1,N_KICKS=0
L5CELL2: RFCW,LSC=1,CELL_LENGTH=1,L=0.07000000000000001,PHASE=96,FREQ=2856000000,CHANGE_P0=1,&
END1_FOCUS=1,END2_FOCUS=1,N_KICKS=0
L5CELL4: RFCW,LSC=1,CELL_LENGTH=1,L=0.14,PHASE=96,FREQ=2856000000,CHANGE_P0=1,END1_FOCUS=1,&
END2_FOCUS=1,N_KICKS=0
L5CELL8: RFCW,LSC=1,CELL_LENGTH=1,L=0.28,PHASE=96,FREQ=2856000000,CHANGE_P0=1,END1_FOCUS=1,&
END2_FOCUS=1,N_KICKS=0
L5CM: LSCDRIFT,LSC=1,BINS=1024,L=0.05
L5CMM: LSCDRIFT,LSC=1,BINS=1024,L="0.05 .0061 2 / -"
LAP: ECOL,X_MAX=0.008,Y_MAX=0.008
"LTP:FL3": MARK
"LTP:H": HKICK,L=0.06
"LTP:H3": HKICK,L=0.06
"LTP:H4": HKICK,L=0.06
"LTP:HV": KICKER,L=0.06
"LTP:PH": HMON
"LTP:PH4": HMON
"LTP:PV": VMON
"LTP:PV4": VMON
"LTP:Q10": QUAD,L=0.3061,K1=0.6355035990105271
"LTP:Q6": KQUAD,L=0.3061,K1=0.08216551949232535
"LTP:Q7": KQUAD,L=0.3061,K1=-0.07990677646069387
"LTP:Q8": QUAD,L=0.3061,K1=0.5672477805713856
"LTP:Q8M": MARK,FITPOINT=1
"LTP:Q9": QUAD,L=0.3061,K1=-0.7034516034898461
"LTP:V": VKICK,L=0.06
"LTP:V3": VKICK,L=0.06
"LTP:V4": VKICK,L=0.06
LTPAMQ: LSCDRIFT,LSC=1,BINS=1024,L=1.332796
LTPL10: LSCDRIFT,LSC=1,BINS=1024,L=2.413615999
LTPL12: LSCDRIFT,LSC=1,BINS=1024,L="1.671862 0.3127372 -"
LTPL1C: LSCDRIFT,LSC=1,BINS=1024,L=0.1524
LTPL7: LSCDRIFT,LSC=1,BINS=1024,L=0.59678
LTPL7A: LSCDRIFT,LSC=1,BINS=1024,L=0.54769565582951
LTPL8A: LSCDRIFT,LSC=1,BINS=1024,L=1.462329
LTPL8B: LSCDRIFT,LSC=1,BINS=1024,L=0.20113
LTPL9: LSCDRIFT,LSC=1,BINS=1024,L=1.945838
LTPLMQ: LSCDRIFT,LSC=1,BINS=1024,L=0.18739
LTPLQC: LSCDRIFT,LSC=1,BINS=1024,L=0.12017
LTPLQC1: LSCDRIFT,LSC=1,BINS=1024,L=0.10525
LTPQAM: LSCDRIFT,LSC=1,BINS=1024,L=0.353
MALIN: MALIGN
"PB:HC1": HKICK,L=0.06
"PB:FL:C1": mark
"PL:QM1": LSCDRIFT,LSC=1,BINS=1024,L=0.15
"L4:QM6": QUAD,L=1e-10,K1=186315267.572242
"L4:QM6M": MARK,FITPOINT=1
"L4:QM7": QUAD,L=1e-10,K1=-162270758.173484
"L4:QM7M": MARK,FITPOINT=1
"L5:QM1": QUAD,L=1e-10,K1=158047749.256991
"L5:QM1M": MARK,FITPOINT=1
"L5:QM2": QUAD,L=1e-10,K1=-180869662.348401
"L5:QM2M": MARK,FITPOINT=1
"L5:QM3": QUAD,L=1e-10,K1=144851501.375992
"L5:QM3M": MARK,FITPOINT=1
"L5:QM4": QUAD,L=1e-10,K1=-126230467.458094
"L5:QM4M": MARK,FITPOINT=1
"L4:QM1": QUAD,L=1e-10,K1=-624048350.085627
"L4:QM1M": MARK,FITPOINT=1
"L4:QM2": QUAD,L=1e-10,K1=1141893095.39303
"L4:QM2M": MARK,FITPOINT=1
"L4:QM3": QUAD,L=1e-10,K1=-781824060.986295
"L4:QM3M": MARK,FITPOINT=1
"L4:QM4": QUAD,L=1e-10,K1=189282574.859488
"L4:QM4M": MARK,FITPOINT=1
"L4:QM5": QUAD,L=1e-10,K1=-158669629.666062
"L4:QM5M": MARK,FITPOINT=1
Q: CHARGE,TOTAL=300e-12
ZWAKE: WAKE,INPUTFILE="knsl45.liwake.sdds",TCOLUMN="t",WCOLUMN="W",FACTOR=86,&
N_BINS=0,INTERPOLATE=1,CHANGE_P0=1,allow_long_beam=1
L2AS1: LINE=(L2AS1M,L2AS1BEG,LAP,L2CELL12,4*("L2:QM1",L2CELL1),"L2:QM1","L2:QM1M",L2CELL4,&
4*("L2:QM2",L2CELL1),"L2:QM2","L2:QM2M",3*L2CELL16,L2CELL14,ZWAKE,LAP,L2AS1END,L2AS1M)
L1OtoALF2: LINE=(LAP,L1L,L1DSF,L1AS1AL1,L1AL1SC1,"L1:SC1",L1SC1Q1,"L1:QM1",&
L1Q1Q2,"L1:QM2",L1Q2SC2,"L1:SC2",L1SC2AL2,LAP)
RG2AMtoL2AS1I: LINE=(LAP,L1AL2SC3,"L1:SC3",L1SC3Q3,"L1:QM3",L1Q3Q4,"L1:QM4",&
L1Q4Q5H1,"L1:PM1",L1Q4Q5H2,"L1:QM5",L1Q5SC4,"L1:SC4",L1SC4L,"LI:FL:FS1",LIFS1L,LAP)
RG2AMtoL2AS1O: LINE=(RG2AMtoL2AS1I,L2AS1)
L1OtoL2AS1O: LINE=(L1OtoALF2,RG2AMtoL2AS1I,L2AS1)
L2AS2: LINE=(L2AS2M,L2AS2BEG,LAP,L2CELL2,L2CELL1,8*("L2:QM3",L2CELL1),"L2:QM3","L2:QM3M",L2CELL4,L2CELL2,&
8*("L2:QM4",L2CELL1),"L2:QM4","L2:QM4M",3*L2CELL16,L2CELL1,L2CELL4,L2CELL8,ZWAKE,LAP,L2AS2END,L2AS2M)
L2AS3: LINE=(L2AS3M,L2AS3BEG,LAP,L2CELL2,L2CELL1,8*("L2:QM5",L2CELL1),"L2:QM5","L2:QM5M",L2CELL4,L2CELL2,&
8*("L2:QM6",L2CELL1),"L2:QM6","L2:QM6M",3*L2CELL16,L2CELL1,L2CELL4,L2CELL8,ZWAKE,LAP,L2AS3END,L2AS3M)
L2AS4: LINE=(L2AS4M,L2AS4BEG,LAP,3*L2CELL16,L2CELL8,L2CELL4,L2CELL1,&
"L2:QM7M",8*("L2:QM7",L2CELL1),"L2:QM7",L2CELL4,L2CELL2,"L2:QM8M",8*("L2:QM8",L2CELL1),"L2:QM8",&
L2CELL2,L2CELL1,ZWAKE,LAP,L2AS4END,L2AS4M)
L2AS12: line=(L2AS12A,L2:SC1,L2SC1L,LI:FL:S1C1,LIS1C1L,L2:PM1,L2PM1L,LI:FL:S1C2,LIS1C2L)
L2AS23: line=(L2AS23A,L2:SC2,L2AS23B,L2AS23C)
L2AS34: line=(L2AS34A,L2:SC3,L2AS34B,L2:PM2,L2AS34C)
RG2AMtoL2O: LINE=(RG2AMtoL2AS1O,L2AS12,L2AS2,L2AS23,L2AS3,L2AS34,L2AS4)
L1OtoL2O: LINE=(L1OtoL2AS1O,L2AS12,L2AS2,L2AS23,L2AS3,L2AS34,L2AS4)
L2: LINE=(L2AS1,L2AS12,L2AS2,L2AS23,L2AS3,L2AS34,L2AS4)
L2AS2ItoL2O: line=(L2AS2,L2AS23,L2AS3,L2AS34,L2AS4)
L2AS3ItoL2O: line=(L2AS3,L2AS34,L2AS4)
L2AS4ItoL2O: line=(L2AS4)
RG2toL2I: LINE=(RG2TOALF2,"L1:RG2:LFA",RG2AMtoL2AS1I)
RG2toL2O: LINE=(RG2toL2I,L2AS1,L2AS12,L2AS2,L2AS23,L2AS3,L2AS34,L2AS4)
BC1: LINE=("L3:BM1M","L3:BM1","L3:BM1M",L3BM1L,"L3:QM1",L3QM1L,&
"L3:BM2M","L3:BM2","L3:BM2M",L3BM2L,"L3:PM1","L3:PM1M","L3PM1L","L3:SCR",&
L3SC1PFIL,L3SCR1L,"L3:FS1",L3FS1L,"L3:BM3M","L3:BM3","L3:BM3M",&
L3BM3L,"L3:QM2M","L3:QM2",L3QM2L,"L3:BM4M","L3:BM4","L3:BM4M")
L2TOBBC: LINE=(L2AS4L1,L2AS4OF,L2AS4L2,"L2:SC4",L2SC4L,"L2:PM3",L2PM3L)
L2OTOL3FS2: LINE=(L2TOBBC,BC1,L3BM4L,"L3:PM2",L3PM2L,"L3:FS2")
RG2toL3FS2: line=(Q,RG2ToL2O,L2OtoL3FS2)
L3FS2TOEBC: line=(L3FS2L,&
"L3:QM3",L3QM3L,"L3:QM4",L3QM4L,"L3:SC1",L3SC1L,"L3:QM5",&
L3QM5L,"L3:QM6",L3QM6L)
L2toEBC: line=(L2OtoL3FS2,L3FS2toEBC)
BC1EM: LINE=("L3:FS3",L3FS3L,"L3:FS4",L3FS4L,&
"L3:CTR",L3CTRL,"L3:SC2",L3SC2L,"L3:PM3",L3PM3L,"L3:FS5")
L2OToL3FS3: line=(L2OtoL3FS2,L3FS2toEBC)
L2OToL3FS5: line=(L2OtoL3FS2,L3FS2toEBC,BC1EM)
RG2toL3FS5: line=(RG2toL3FS2,L3FS2toEBC,BC1EM)
BC1EMD: LINE=("L3:FS3",DDPO,L3FS3L,"L3:FS4",L3FS4L,&
"L3:CTR",L3CTRL,"L3:SC2",L3SC2L,"L3:PM3",L3PM3L,"L3:FS5")
"L3:AM1": SBEN,L=0.193,ANGLE=0.24,E2=0.24,TILT=1.570796326794897,&
FINT=0.288,HGAP=0.02,USE_BN=1,B2=6.31
DDBL: LINE=(Q,DDL1,"L3:AM1",DDL2)
L3FS5ToL4I: line=(L3FS5L)
L2OTOL4I: LINE=(L2OTOL3FS5,L3FS5L)
"L2E:L3FS2": LINE=(L2TOEBC)
L2OTOL4ID: LINE=(L2TOEBC,BC1EMD,L3FS5L)
L4Q2: LINE=(LAP,4*(L4:QM1,L4CELL1,LAP),"L4:QM1M",4*(L4:QM1,L4CELL1,LAP),L4:QM1,LAP)
L4Q3: LINE=(LAP,4*(L4:QM2,L4CELL1,LAP),"L4:QM2M",4*(L4:QM2,L4CELL1,LAP),L4:QM2,LAP)
L4Q4: LINE=(LAP,4*(L4:QM3,L4CELL1,LAP),"L4:QM3M",4*(L4:QM3,L4CELL1,LAP),L4:QM3,LAP)
L4Q5: LINE=(LAP,4*(L4:QM4,L4CELL1,LAP),"L4:QM4M",4*(L4:QM4,L4CELL1,LAP),L4:QM4,LAP)
L4Q6: LINE=(L4CELL8)
L4Q7: LINE=(L4CELL8)
L4AS1S: LINE=(L4AS1M,L4AS1BEG,LAP,L4CELL16,L4Q2,L4CELL1,L4CELL2,L4CELL4,L4CELL8,L4Q3,&
L4CELL1,L4CELL2,L4CELL4,L4CELL8,L4Q4,L4CELL16,ZWAKE,LAP,L4AS1END,L4AS1M)
L4AS12: line=(l4as12a,l4:sc1,l4sc1l,LI:FL:FS4,LIFS4L)
L4AS2S: LINE=(L4AS2M,L4AS2BEG,LAP,L4CELL16,L4Q5,L4CELL1,L4CELL2,L4CELL4,L4CELL8,L4Q6,&
L4CELL1,L4CELL2,L4CELL4,L4CELL8,L4Q7,L4CELL16,ZWAKE,LAP,L4AS2END,L4AS2M)
L4AS23: LINE=(L4AS23D1,L4:SC2,L4AS23D2,L4:PM1,L4AS23D3)
L4Q8: LINE=(LAP,4*(L4:QM5,L4CELL1,LAP),"L4:QM5M",4*(L4:QM5,L4CELL1,LAP),L4:QM5,LAP)
L4Q9: LINE=(L4CELL8)
L4Q10: LINE=(L4CELL8)
L4Q11: LINE=(LAP,4*(L4:QM6,L4CELL1,LAP),"L4:QM6M",4*(L4:QM6,L4CELL1,LAP),L4:QM6,LAP)
L4AS3S: LINE=(L4AS3M,L4AS3BEG,LAP,L4CELL2,L4CELL2,L4Q8,L4CELL1,L4CELL4,L4Q9,2*L4CELL16,&
L4CELL2,L4CELL1,L4Q10,L4CELL4,L4CELL1,L4Q11,L4CELL4,L4CELL1,ZWAKE,LAP,L4AS3END,L4AS3M)
L4AS34: LINE=(L4AS34D1,L4:SC3,l4as34d2,L4:PM2,L4PM2L,LI:FL:FS5,LIFS5L)
L4Q12: LINE=(L4CELL8)
L4Q13: LINE=(L4CELL8)
L4Q14: LINE=(LAP,4*(L4:QM7,L4CELL1,LAP),"L4:QM7M",4*(L4:QM7,L4CELL1,LAP),L4:QM7,LAP)
L4AS4S: LINE=(L4AS4M,L4AS4BEG,LAP,L4CELL1,L4CELL1,L4CELL4,L4Q12,L4CELL16,L4CELL1,L4Q13,&
2*L4CELL16,L4CELL2,L4Q14,L4CELL4,L4CELL1,ZWAKE,LAP,L4AS4END,L4AS4M)
L4TOL5: LINE=(L42L5D1,L4:SC4,l42l5d2,L4:PM3,L42L5D3)
L4: LINE=(L4AS1S,L4AS12,L4AS2S,L4AS23,L4AS3S,L4AS34,L4AS4S,L4TOL5)
L5Q15: LINE=(L5CELL8)
L5Q16: LINE=(L5CELL8)
L5Q17: LINE=(LAP,4*(L5:QM1,L5CELL1,LAP),"L5:QM1M",4*(L5:QM1,L5CELL1,LAP),L5:QM1,LAP)
L5AS1S: LINE=(L5AS1M,L5AS1BEG,LAP,L5CELL4,L5CELL4,L5CELL1,L5Q15,L5CELL16,L5CELL2,L5CELL2,&
L5Q16,L5CELL16,L5CELL8,L5CELL2,L5Q17,L5CELL4,L5CELL1,L5CELL2,ZWAKE,LAP,L5AS1END,L5AS1M)
L5AS12: LINE=(L5AS12D1,L5:SC1,L5SC1L,LI:FL:FS6,LIFS6L)
L5Q18: LINE=(L5CELL8)
L5Q19: LINE=(L5CELL8)
L5Q20: LINE=(LAP,4*(L5:QM2,L5CELL1,LAP),"L5:QM2M",4*(L5:QM2,L5CELL1,LAP),L5:QM2,LAP)
L5AS2S: LINE=(L5AS2M,L5AS2BEG,LAP,L5CELL4,L5CELL4,L5CELL2,L5CELL1,L5Q18,L5CELL16,L5CELL4,&
L5CELL1,L5Q19,L5CELL16,L5CELL4,L5CELL2,L5CELL1,L5Q20,L5CELL4,L5CELL2,L5CELL1,&
ZWAKE,LAP,L5AS2END,L5AS2M)
L5AS23: LINE=(L5AS23D1,L5:SC2,L5SC2L,L5:PM2,L5PM2L,LI:FL:FS7,LIFS7L)
L5Q21: LINE=(L5CELL8)
L5Q22: LINE=(LAP,4*(L5:QM3,L5CELL1,LAP),"L5:QM3M",4*(L5:QM3,L5CELL1,LAP),L5:QM3,LAP)
L5AS3S: LINE=(L5AS3M,L5AS3BEG,LAP,L5CELL8,L5CELL4,L5CELL2,L5Q21,L5CELL2,L5CELL16,L5CELL2,&
L5CELL1,L5Q22,2*L5CELL16,L5CELL1,L5CELL2,ZWAKE,LAP,L5AS3END,L5AS3M)
L5AS34: LINE=(L5AS34D1,L5:SC3,l5as34d2,L5:PM3,L5PM3L,LI:FL:FS8,LIFS8L)
L5Q23: LINE=(L5CELL8)
L5Q24: LINE=(LAP,4*(L5:QM4,L5CELL1,LAP),"L5:QM4M",4*(L5:QM4,L5CELL1,LAP),L5:QM4,LAP)
L5AS4S: LINE=(L5AS4M,L5AS4BEG,LAP,L5CELL8,L5CELL4,L5CELL2,L5Q23,L5CELL1,2*L5CELL16,L5CELL8,&
L5Q24,L5CELL8,L5CELL4,L5CELL2,L5CELL1,ZWAKE,LAP,L5AS4END,L5AS4M)
L5AS4SL: drift,l=0.107273
L5SC4L: drift,l=0.409014
L5PM4L: drift,l=0.1027372
L5: LINE=(L5AS1S,L5AS12,L5AS2S,L5AS23,L5AS3S,L5AS34,L5AS4S,L5AS4SL,L5:SC4,L5SC4L,L5:PM4,&
        L5PM4L,LI:FL:FS9)
L1TOBBC: LINE=(Q,L1OtoL2O,L2TOBBC)
L1TOEBC: LINE=(Q,L1OtoL2O,L2TOEBC)
LINAC: LINE=(Q,L1OtoL2O,L2OtoL4I,L4,L5)
RG2Linac: line=(Q,RG2ToL2O,L2OtoL4I,L4,L5)
LINACD: LINE=(Q,L1OtoL2O,L2OtoL4ID,L4,L5)
L1OtoL3FS2: line=(Q,L1OtoL2O,L2OtoL3FS2)
L2ItoL3FS3: line=(Q,INITTWISS,L2,L2OtoL3FS3)
L1OtoL3FS3IT: line=(Q,INITTWISS,L1OtoL2O,L2OtoL3FS3)
L2ItoL3FS3IT: line=(Q,INITTWISS,L2,L2OtoL3FS3)
L2ItoL3FS5: line=(Q,L2,L2OtoL3FS5)
L2AS2ItoL3FS3: line=(Q,INITTWISS,L2AS2ItoL2O,L2OtoL3FS3)
L2AS3ItoL3FS3: line=(Q,INITTWISS,L2AS3ItoL2O,L2OtoL3FS3)
L2AS4ItoL3FS3: line=(Q,INITTWISS,L2AS4ItoL2O,L2OtoL3FS3)
RG2AMtoL3FS3IT: line=(Q,INITTWISS,RG2AMtoL2O,L2OtoL3FS3)
L2AS2ItoL3FS3IT: line=(Q,INITTWISS,L2AS2ItoL2O,L2OtoL3FS3)
L2AS3ItoL3FS3IT: line=(Q,INITTWISS,L2AS3ItoL2O,L2OtoL3FS3)
L2AS4ItoL3FS3IT: line=(Q,INITTWISS,L2AS4ItoL2O,L2OtoL3FS3)
RG2AMtoL3FS5: line=(Q,RG2AMtoL2O,L2OtoL3FS5)
L2AS2ItoL3FS5: line=(Q,L2AS2ItoL2O,L2OtoL3FS5)
L2AS3ItoL3FS5: line=(Q,L2AS3ItoL2O,L2OtoL3FS5)
L2AS4ItoL3FS5: line=(Q,L2AS4ItoL2O,L2OtoL3FS5)
L1OtoL3FS5: line=(Q,L1OtoL2O,L2OtoL3FS5)
LIN4: LINE=(Q,L1OtoL2O,L2OtoL4I)
LIN4D: LINE=(Q,L1OtoL2O,L2OtoL4ID)
L4ItoL5O: LINE=(Q,L4,L5)
LTPL11: LINE=(LTPQAM,"L5:AM1",LTPAMQ)

! Tcav definition
! 10 May S. Shin
LTPH42TCAV: LSCDRIFT,LSC=1,BINS=1024,L=0.5331
TCAVDFT1: LSCDRIFT,LSC=1,BINS=1024,L=0.1233
LTPL104: LSCDRIFT,LSC=1,BINS=1024,L=0.60340399975
MDF: MARK,FITPOINT=1
LTPL92: LSCDRIFT,LSC=1,BINS=1024,L=0.972919
LTPL8A2: LSCDRIFT,LSC=1,BINS=1024,L=0.731164500000002
! Tcav voltage set to 0
! Please set voltage whatever you want
TCAV: RFDF,L=0.55,PHASE=90,TILT=1.570796,VOLTAGE=0.000000 

! LTP1 with Tcav
! 10 May S. Shin
!LTP1: LINE=("LTP:HV",LTPL12,"LTP:Q10",LTPLQC,"LTP:V4",LTPL11,&
! "LTP:Q9",LTPLQC,"LTP:H4",LTPH42TCAV,TCAV,TCAVDFT1,LTPL104,MDF,LTPL104,&
! "LTP:Q8",LTPL92,LTPL92,"LTP:PV4",LTPLMQ,"LTP:Q7",LTPLQC,"LTP:V3",LTPL8A2,&
! LTPL8A2,"LTP:FL3",LTPL8B,"LTP:PH4",LTPLMQ,"LTP:Q6",LTPLQC)


!Original LTP1. This have no Tcav. 
! 10 May S. Shin
LTP1: LINE=("LTP:HV",LTPL12,"LTP:Q10",LTPLQC,"LTP:V4",LTPL11,"LTP:Q9",LTPLQC,&
"LTP:H4",LTPL10,"LTP:Q8",LTPL9,"LTP:PV4",LTPLMQ,"LTP:Q7",LTPLQC,"LTP:V3",&
LTPL8A,"LTP:FL3",LTPL8B,"LTP:PH4",LTPLMQ,"LTP:Q6",LTPLQC)

LINLTP: LINE=(LINAC,LTP1)
PB1: LINE=(LTP1,L5CM,"PB:HC1",LTPL7A,BYPLV1,4*BYPL1,"PB:Q1",2*BYPL2,"PB:Q2",&
BYPL2A,PB:FL:C1)
PB1R: LINE=(-PB1)
L4PB: LINE=(Q,L4,L5,PB1)
L5PB: LINE=(Q,L5,PB1)
L3FS5ToL5O: line=(Q,L3FS5ToL4I,L4,L5)
L3FS5ToPBC1: line=(Q,L3FS5ToL4I,L4,L5,PB1)
LPBD: LINE=(MALIN,LINACD,PB1)
LPB: LINE=(MALIN,LINAC,PB1)

M20:MARK
M11:MARK
L5M:DRIFT,L=5.
M10:MARK  !WALL DOWNSTRAM END
M5:MARK
M6:MARK
M7:MARK
M13:MARK
M8:MARK
M9:MARK
M1:MARK
M2: MARK !BEND POINT
MU:MARK!UNDULATOR START
M3:MARK ! VIEWSCREEN
L1M:DRIFT,L=1.
HMON:DRIFT,L=0.0
VMON:DRIFT,L=0.
HCOR:DRIFT,L=.06
VCOR:DRIFT,L=.06
HCOR1:DRIFT,L=.03
VCOR1:DRIFT,L=.03
HVCOR:LINE=(HCOR1,VCOR1)
PART1:LINE=(L5CM,HCOR,LTPL7,BYPLV1,M2)
PART2A: LINE=(4*BYPL3)
PART2B: LINE=(4*BYPL4,M3,BYPL5,"PB:Q3",BYPL6,"PB:Q4",4*BYPL7,M2)

"PTB:FL1": MARKER
"PTB:FL2": MARKER
"PTB:FL3": MARKER
"PTB:CM1": MARKER
"PTB:PH": HMONITOR, L=0.0
"PTB:PH1":  HMONITOR, L=0.0
"PTB:PH2":  HMONITOR, L=0.0
"PTB:PH3": HMONITOR, L=0.0
"PTB:PH4":  HMONITOR, L=0.0
"PTB:PH5":  HMONITOR, L=0.0
"PTB:PV": VMONITOR, L=0.0
"PTB:PV1": VMONITOR, L=0.0
"PTB:PV2": VMONITOR, L=0.0
"PTB:PV3": VMONITOR, L=0.0
"PTB:PV4": VMONITOR, L=0.0
"PTB:PV5": VMONITOR, L=0.0

"PTB:H": hkick, L=0.06
"PTB:H1": hkick, L=0.06
"PTB:H2": hkick, L=0.06
"PTB:H3": hkick, L=0.06
"PTB:H4": hkick, L=0.06
"PTB:V":  vkick, L=0.06
"PTB:V1": vkick, L=0.06
"PTB:V2": vkick, L=0.06
"PTB:V3": vkick, L=0.06
"PTB:V4": vkick, L=0.06

PTBDCOR: LSCDRIFT,LSC=1,BINS=1024, L=0.06
PTBLCQ: LSCDRIFT,LSC=1,BINS=1024, L=0.19847
PTBL1A: LSCDRIFT,LSC=1,BINS=1024, L=0.832346
PTBL1B: LSCDRIFT,LSC=1,BINS=1024, L=0.73954
PTBL1C: LSCDRIFT,LSC=1,BINS=1024, L=1.26982
PTBL2A: LSCDRIFT,LSC=1,BINS=1024, L=0.49695
PTBL2B: LSCDRIFT,LSC=1,BINS=1024, L=0.23848
PTBL3: LSCDRIFT,LSC=1,BINS=1024, L=0.73543
PTBL4: LSCDRIFT,LSC=1,BINS=1024, L=0.73543
PTBL5: LSCDRIFT,LSC=1,BINS=1024, L=0.73543
PTBL6: LSCDRIFT,LSC=1,BINS=1024, L=0.8959425
PTBL7: LSCDRIFT,LSC=1,BINS=1024, L=0.3374724
PTBL7E: drift,l="2.125276e-01 0.3374724 +"
PTBL8: LSCDRIFT,LSC=1,BINS=1024, L=0.33543
PTBL8E: LSCDRIFT,LSC=1,BINS=1024, L="0.33543 -1.045700e-01 -"
PTBL9: LSCDRIFT,LSC=1,BINS=1024,L=0.86284027
PTBL9A: LSCDRIFT,LSC=1,BINS=1024, L=0.4897903
PTBL9B: LSCDRIFT,LSC=1,BINS=1024, L=0.26848
PTBL10: LSCDRIFT,LSC=1,BINS=1024, L=0.33543
PTBL10E: LSCDRIFT,LSC=1,BINS=1024, L="0.33543 -1.045700e-01 -"
PTBL11: LSCDRIFT,LSC=1,BINS=1024, L=0.5969501
PTBL12A: LSCDRIFT,LSC=1,BINS=1024, L=0.13
PTBL12B: LSCDRIFT,LSC=1,BINS=1024, L="1.706443 3 .0254 * +"
PTBL13A: LSCDRIFT,LSC=1,BINS=1024, L="0.60895 3 .0254 * -"
PTBL13B: LSCDRIFT,LSC=1,BINS=1024, L=0.28495
PTBL14: LSCDRIFT,LSC=1,BINS=1024, L=0.12695
PTBL15A: LSCDRIFT,LSC=1,BINS=1024, L=0.13
PTBL15B: LSCDRIFT,LSC=1,BINS=1024, L=0.38
PTBLEX: LSCDRIFT,LSC=1,BINS=1024, L=0.012222019872

"PTB:Q1": QUADRUPOLE, L=0.3061, K1=-1.099363470786
"PTB:Q2": QUADRUPOLE, L=0.3061, K1=3.733692122099
"PTB:Q3": QUADRUPOLE, L=0.3061, K1=-4.594014661692
"PTB:Q4": QUADRUPOLE, L=0.3061, K1=4.883967503824
"PTB:Q5": QUADRUPOLE, L=0.1491, K1=-8.42217
"PTB:Q6": QUAD,L=0.3061,K1=3.277232461798218
"PTB:Q7": QUAD,L=0.3061,K1=-2.301062398006379
"PTB:Q8": QUAD,L=0.3061,K1=0.2417745730106508
"PTB:Q9": QUAD,L=0.3061,K1=-1.139293980093812
PTBQ6M: MARKER,FITPOINT=1
PTBQ7M: MARKER,FITPOINT=1
PTBQ8M: MARKER,FITPOINT=1
PTBQ9M: MARKER,FITPOINT=1
"PTB:Q10": QUADRUPOLE, L=0.3061, K1=1.682910995725
"PTB:Q11": QUADRUPOLE, L=0.3061, K1=-1.000004367337
"P:ESP": SBEND, L=0.4, ANGLE=0.2, E1=0.0, E2=0.2, HGAP=0.01, FINT=0.5
"PTB:B1": SBEND, L=0.40200836736, ANGLE=-0.2, E1=-0.1, E2=-0.1, HGAP=0.02, FINT=0.5
"PTB:B2": SBEND, L=0.401681, ANGLE=0.187402, E1=0.093701, E2=0.093701, HGAP=0.02, FINT=0.5
"B:IS": SBEND, L=0.8, ANGLE=-0.271795124688, E1=-0.135897562344, E2=&
-0.135897562344, HGAP=0.01, FINT=0.5
PTBB1M: mark,fitpoint=1 
PTBB2M: mark,fitpoint=1

PARtoPTBB1O: LINE=("P:ESP",PTBL1A,"PTB:V1",PTBL1B,"PTB:FL1",PTBL1C,"PTB:Q1",PTBL2A,&
    "PTB:CM1",PTBL2B,"PTB:PH1","PTB:H1",PTBLCQ,"PTB:Q2",PTBL3,"PTB:PV1",&
    PTBDCOR,PTBLCQ,"PTB:Q3",PTBL4,"PTB:PH2","PTB:H2",&
    PTBLCQ,"PTB:Q4",PTBL5,"PTB:PV2","PTB:V2",PTBLCQ,&
    "PTB:Q5",PTBL6,"PTB:B1",PTBB1M)
PTBB1OtoPTBB2I: line=(PTBL7,"PTB:PH3","PTB:H3",PTBLCQ,&
    "PTB:Q6",PTBQ6M,PTBL8,"PTB:PV3","PTB:V3",PTBLCQ,"PTB:Q7",PTBQ7M,PTBL9A,"PTB:FL2",&
    PTBL9B,"PTB:H4",PTBLCQ,"PTB:Q8",PTBQ8M,PTBL10,"PTB:V4","PTB:PV4",PTBLCQ,&
    "PTB:Q9",PTBQ9M,PTBL11)
PTBB2ItoBISO: line=("PTB:B2",PTBB2M,PTBL12A,"PTB:PH4",PTBL12B,"PTB:Q10",PTBL13A,&
    "PTB:FL3",PTBL13B,"PTB:Q11",PTBL14,"PTB:PH5",2*PTBL15A,"PTB:PV5",&
    PTBL15A,PTBL15B,PTBLEX,"B:IS")
PARtoBISO: line=(PARtoPTBB1O,PTBB1OtoPTBB2I,PTBB2ItoBISO)

LB4: LSCDRIFT,LSC=1,BINS=1024, L=1.55
QB2: QUADRUPOLE, L=0.5, K1=-0.638272
LB3: LSCDRIFT,LSC=1,BINS=1024, L=0.5115
BBM: SBEND, L=3.077, ANGLE=0.09239978, E1=0.04619989, E2=0.04619989
LB2: LSCDRIFT,LSC=1,BINS=1024, L=0.5115
QB1: QUADRUPOLE, L=0.5, K1=0.710565
LB1: LSCDRIFT,LSC=1,BINS=1024, L=4.1
PTBtoBFP: LINE=(PARtoBISO,LB4,QB2,LB3,BBM,LB2,QB1,LB1)

!!-------Booster Bypass -------------------
PTBBB2: LSCDRIFT,LSC=1,BINS=1024,L=0.20058
LTUL0:DRIFT,L=2.49807
LTUL0A: LSCDRIFT,LSC=1,BINS=1024,L="2.49807 23.250 20.750 + .0254 * -"
LTUL0B: LSCDRIFT,LSC=1,BINS=1024,L="20.750 .0254 * .1527 -"
LTUL0C: LSCDRIFT,LSC=1,BINS=1024,L="23.250 .0254 * .1527 -"
"BB:QE1": QUAD,L=0.1527,K1=4.74560172850832
"BB:QE2": QUAD,L=0.1527,K1=-5.945073332364418
"BB:Q1": QUAD,L=0.1527,K1=2.547910206262211
BBQ1M: MARK,FITPOINT=1
PART3A:LINE=(BYPLV1,PTBL7E,HMON,L5CMM,"PTB:Q6",PTBQ6M,L5CMM,HCOR,PTBL8E,&
L5CMM,"PTB:Q7",PTBQ7M,L5CMM,VCOR,PTBL9,HMON,L5CMM,"PTB:Q8",PTBQ8M,L5CMM,HCOR,&
PTBL10E,VMON,L5CMM,"PTB:Q9",PTBQ9M,PTBL11)
PART3B: line=(PTBBB2,LTUL0A,"BB:QE1",LTUL0B,"BB:QE2",LTUL0C,"BB:Q1",BBQ1M,M5)
PART3:LINE=(PART3A,PART3B)

LTUL1:DRIFT,L=.28365

!
! CSR option for Bypass bending
! 09 May 2017 S. Shin

!"BB:BM1":SBEND,L=.11,ANGLE=-.0093618877,TILT=1.570796327
!"BB:BM2":SBEND,L=.11,ANGLE= .0093618877,TILT=1.570796327
"BB:BM1":csrcsbend,L=.11,ANGLE=-.0093618877,TILT=1.570796327,&
 nonlinear=1,n_kicks=100,integration_order=4,SLICE_ANALYSIS_INTERVAL=50,&
 bins=500,sg_halfwidth=1,output_file="%s.BM1.csr",output_interval=10
"BB:BM2":csrcsbend,L=.11,ANGLE= .0093618877,TILT=1.570796327,&
 nonlinear=1,n_kicks=100,integration_order=4,SLICE_ANALYSIS_INTERVAL=50,&
 bins=500,sg_halfwidth=1,output_file="%s.BM2.csr",output_interval=10

!SP:DRIFT,L=.06
SP:CSRDRIFT,L=.06,dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50

VB1:LINE=("BB:BM1",SP,"BB:BM1",SP,"BB:BM1")
VB2:LINE=("BB:BM2",SP,"BB:BM2",SP,"BB:BM2")

!LTUL2:DRIFT,L=1.66173004 !USE 5
LTUL2:csrdrift,L=1.66173004,dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50 !USE 5
"BB:Q2":QUAD,L=0.1527,K1=-1.48129904

!LTUL3:DRIFT,L=1.80846 !USE 5
LTUL3:CSRDRIFT,L=1.80846,dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50 !USE 5
PART4:LINE=(LTUL1,VB1,5*LTUL2,"BB:Q2",M6,5*LTUL3)

!LTUL6: LSCDRIFT,LSC=1,BINS=1024,L=.28365
!LTUL5: LSCDRIFT,LSC=1,BINS=1024,L=1.66173004 !USE 5
LTUL6: CSRDRIFT,L=.28365,dz=0.001,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50
LTUL5: CSRDRIFT,L=1.66173004,dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50 !USE 5

"BB:Q3": QUAD,L=0.1527,K1=+.927768361
"BB:Q4": QUAD,L=0.1527,K1=-1.48129904

!LTUL4:DRIFT,L=1.80846 !USE 5
LTUL4:CSRDRIFT,L=1.80846,dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50 !USE 5

PART5:LINE=("BB:Q3",5*LTUL4,"BB:Q4",5*LTUL5,VB2,LTUL6)

BBQ5M: MARK,FITPOINT=1

!UML1: LSCDRIFT,LSC=1,BINS=1024,L=.86 !USE 2
UML1: CSRDRIFT,L=.86,dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50 !USE 2
BBQ6M: MARK,FITPOINT=1
!UML2: LSCDRIFT,LSC=1,BINS=1024,L=1.43 
UML2: CSRDRIFT,L=1.43,dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50 
LAQ1M:MARK,FITPOINT=1
!UML3: LSCDRIFT,LSC=1,BINS=1024,L=.5 !USE 2
UML3: CSRDRIFT,L=.5,dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50 !USE 2
LAQ2M:MARK,FITPOINT=1
!UML4: LSCDRIFT,LSC=1,BINS=1024,L=2.43865
UML4: CSRDRIFT,L=2.43865,dz=0.01,use_stupakov=1,SLICE_ANALYSIS_INTERVAL=50
UML5: LSCDRIFT,LSC=1,BINS=1024,L=0.302
"LA:SC1":DRIFT,L=0.1
LEAWALL: drift,l=1.238

!
! End of CSR at bypass 
!


! LEA lattice begins from LE:GV1 gate valve

!-------drifts-----------------
LED1A: LSCDRIFT,LSC=1,BINS=1024,L=0.4027
LED1B: LSCDRIFT,LSC=1,BINS=1024,L=0.079
LED1C: LSCDRIFT,LSC=1,BINS=1024,L=0.33665
LED2A: LSCDRIFT,LSC=1,BINS=1024,L=0.28
LED2B: LSCDRIFT,LSC=1,BINS=1024,L=0.295
LED2C: LSCDRIFT,LSC=1,BINS=1024,L=0.16535
LED3A: LSCDRIFT,LSC=1,BINS=1024,L=0.25367
LED3B: LSCDRIFT,LSC=1,BINS=1024,L=0.0288
LED3C: LSCDRIFT,LSC=1,BINS=1024,L=0.1132
LED3D: LSCDRIFT,LSC=1,BINS=1024,L=0.1824
LED4A: LSCDRIFT,LSC=1,BINS=1024,L=0.1016
LED4B: LSCDRIFT,LSC=1,BINS=1024,L=0.2063
LED4C: LSCDRIFT,LSC=1,BINS=1024,L=0.0667
LED4D: LSCDRIFT,LSC=1,BINS=1024,L=0.1256
LED5A: LSCDRIFT,LSC=1,BINS=1024,L=0.1591
LED5B: LSCDRIFT,LSC=1,BINS=1024,L=0.0673
LED5C: LSCDRIFT,LSC=1,BINS=1024,L=0.175
LED5D: LSCDRIFT,LSC=1,BINS=1024,L=0.0986
LED6A: LSCDRIFT,LSC=1,BINS=1024,L=0.1354
LED6B: LSCDRIFT,LSC=1,BINS=1024,L=0.294
LED6C: LSCDRIFT,LSC=1,BINS=1024,L=0.2209
LED7A: LSCDRIFT,LSC=1,BINS=1024,L=0.23545
LED7B: LSCDRIFT,LSC=1,BINS=1024,L=0.2577
LED7C: LSCDRIFT,LSC=1,BINS=1024,L=0.2208
LED8A: LSCDRIFT,LSC=1,BINS=1024,L=0.50945
LED9A: LSCDRIFT,LSC=1,BINS=1024,L=0.069  !0.17365
LED9B: LSCDRIFT,LSC=1,BINS=1024,L=0.03  !0.1
LED9C: LSCDRIFT,LSC=1,BINS=1024,L=0.3287  !0.154
!LED10A:DRIFT,L=4.0 
!LED10A:DRIFT,L=2.0  !for LEA
LED10A:DRIFT,L=0.5  !for TESSA
DUTT: drift,L=0.2
LED11:DRIFT,L=0.15  !L=0.70956
LED13:DRIFT,L=0.6    !0.4
LED12A: LSCDRIFT,LSC=1,BINS=1024,L=0.15
LED12B: LSCDRIFT,LSC=1,BINS=1024,L=0.104
LED12C: LSCDRIFT,LSC=1,BINS=1024,L=0.26065
!TED1: LSCDRIFT,LSC=1,BINS=1024,L=0.32
TED1A: LSCDRIFT,LSC=1,BINS=1024,L=0.16
TED1B: LSCDRIFT,LSC=1,BINS=1024,L=0.187
TED2: LSCDRIFT,LSC=1,BINS=1024,L=0.12
TED3: LSCDRIFT,LSC=1,BINS=1024,L=0.281			 

!-------Correctors-----------------
"LE:SC1": LSCDRIFT,LSC=1,BINS=1024,L=0.1
"LE:SC2": LSCDRIFT,LSC=1,BINS=1024,L=0.1
"LE:SC3": LSCDRIFT,LSC=1,BINS=1024,L=0.1
"LE:SC4": LSCDRIFT,LSC=1,BINS=1024,L=0.1
"LE:SC5": LSCDRIFT,LSC=1,BINS=1024,L=0.1
"LE:SC6": LSCDRIFT,LSC=1,BINS=1024,L=0.1
"LE:SC7": LSCDRIFT,LSC=1,BINS=1024,L=0.1

!-------BPMs-----------------
"LE:BPM1":DRIFT,L=0.01
"LE:BPM2":DRIFT,L=0.01
"LE:BPM3":DRIFT,L=0.01
"LE:BPM4":DRIFT,L=0.08
"LE:BPM5":DRIFT,L=0.01

!------YAG screens-----------------
"LE:YAG1":DRIF,L=0.01
"LE:YAG2":DRIF,L=0.01
"LE:YAG3":DRIF,L=0.01
"LE:YAG4":DRIF,L=0.11

!-------Current monitors-----------------
"LE:DCCT1":DRIF,L=0.01
"LE:DCCT2":DRIF,L=0.01

!-------Gate valves and ports-----------------
"LE:GV1":DRIF,L=0.072 
"LE:GV2":DRIF,L=0.072 
"LE:GV3":DRIF,L=0.072
"LE:LASER":DRIF,L=0.072

!-------Markers-----------------
DUTC: MARK
LSQ1M:MARK,FITPOINT=1
LSQ2M:MARK,FITPOINT=1
LEAB: WATCH,FILENAME="LEAbeam.sdds"

!-------Bending magnet-----------------
!DMAG:SBEND,L=.40269858,TILT=1.570796,ANGLE=.20072,E1=.0,E2=.20072
DMAG:DRIFT,L=.40269858

!!--------Quadrupoles for betax=0.2m and betay=4m at the IP and for optimal Twiss function at TESSA ------
! update 01/16/2017
"BB:Q5": QUAD,L=0.1527,K1=2.049199
"BB:Q6": QUAD,L=0.1527,K1=-2.916634
"LA:Q1": QUAD,L=0.1527,K1=1.916891
"LA:Q2": QUAD,L=0.1527,K1=-2.803984
"LE:Q1": QUAD,L=0.100,K1=5.041850
"LE:Q2": QUAD,L=0.1527,K1=-6.27474
"LE:Q3": QUAD,L=0.1,K1= 8.368889
"LE:Q4": QUAD,L=0.1,K1= 8.368889 

! Matching to entrance of the buncher
!"LE:Q5": QUAD,L=0.1527,K1=-4.491477180678054e+00
!"LE:Q6": QUAD,L=0.1527,K1=5.891457161721489e+00 
!"LE:Q7": QUAD,L=0.1527,K1=-6.858819828831382e-01 
!"LE:Q8": QUAD,L=0.1527,K1=-6.858819828831382e-01 
!"TE:Q1": QUAD,L=0.064,K1=38.373
!"TE:Q2": QUAD,L=0.064,K1=-38.373

! Matching to entrance of TESSA undulators
"LE:Q5": QUAD,L=0.1527,K1=-5.994014182308655e+00 
"LE:Q6": QUAD,L=0.1527,K1= 5.069904429211483e+00  
"LE:Q7": QUAD,L=0.1527,K1=-1.620535537913635e+00  
"LE:Q8": QUAD,L=0.1527,K1=-1.890044358756986e+00 
"TE:Q1": QUAD,L=0.074,K1= 33.46		
"TE:Q2": QUAD,L=0.074,K1= -33.46


! TESSA Laser Injection Chicane lattice
!************************************************************
!SBEN (bends without CSR effects):
!=======================================
TC_BC1.1: CSRCSBEND,L=0.146, ANGLE=-0.0165, E1=0., E2=0.0,nonlinear=1,n_kicks=100,integration_order=4,SLICE_ANALYSIS_INTERVAL=50,&
 bins=500,sg_halfwidth=1
TC_BC1.2: CSRCSBEND,L=0.146, ANGLE=0.0330, E1=-0., E2=0.0,nonlinear=1,n_kicks=100,integration_order=4,SLICE_ANALYSIS_INTERVAL=50,&
 bins=500,sg_halfwidth=1
TC_BC1.3: CSRCSBEND,L=0.146, ANGLE=-0.0165, E1=0., E2=-0.0,nonlinear=1,n_kicks=100,integration_order=4,SLICE_ANALYSIS_INTERVAL=50,&
 bins=500,sg_halfwidth=1

DRIFT_TC1.1: LSCDRIFT,LSC=1,BINS=1024,L=0.87
DRIFT_TC1.2: LSCDRIFT,LSC=1,BINS=1024,L=0.87

!chicane around the laser injector mirror for TESSA 
TESSA_CHICANE: LINE=(TC_BC1.1, DRIFT_TC1.1, TC_BC1.2, DRIFT_TC1.2, &
                      DRIFT_TC1.2, TC_BC1.3)

! TESSA prebuncher chicane lattice
!************************************************************
!:SBEN (bends without CSR effects):
!=======================================

!PB_BC1.1: RBEN,L=0.146, ANGLE=0.07E-2
!PB_BC1.2: RBEN,L=0.146, ANGLE=-0.14E-2
!PB_BC1.3: RBEN,L=0.146, ANGLE=0.07E-2


PB_BC1.1: CSRCSBEND,L=0.146, ANGLE=0.07E-2, nonlinear=1,n_kicks=100,integration_order=4,SLICE_ANALYSIS_INTERVAL=50,&
 bins=500,sg_halfwidth=1
PB_BC1.2: CSRCSBEND,L=0.146, ANGLE=-0.14E-2,nonlinear=1,n_kicks=100,integration_order=4,SLICE_ANALYSIS_INTERVAL=50,&
 bins=500,sg_halfwidth=1
PB_BC1.3: CSRCSBEND,L=0.146, ANGLE=0.07E-2,nonlinear=1,n_kicks=100,integration_order=4,SLICE_ANALYSIS_INTERVAL=50,&
 bins=500,sg_halfwidth=1


DRIFT_PB1.1: LSCDRIFT,LSC=1,BINS=1024,L=0.015
DRIFT_PB1.2: LSCDRIFT,LSC=1,BINS=1024,L=0.015

!chicane for microbunching after laser modulation 
PREBUNCHER_CHICANE: LINE =(PB_BC1.1, DRIFT_PB1.1, PB_BC1.2, DRIFT_PB1.2, PB_BC1.3)

TE_PBU: CWIGGLER,L=0.288,B_MAX=0.9459,PERIODS=9,SINUSOIDAL=1,HELICAL=1  !prebuncher undulator


!
! 09 May 2017 Wakefield implementation
!
!LEAWake: WAKE,INPUTFILE="longitudinal_w_type1.sdds",factor=1, INTERPOLATE=1,SG_HALFWIDTH=4,&
!         CHANGE_P0=0,tColumn="t",wColumn="W",N_BINS=0,SMOOTHING=1
!LEAtrWake: TRWAKE,INPUTFILE="transverse_w_type1.sdds",INTERPOLATE=1,&
!         tColumn="t",WXCOLUMN="Wx",N_BINS=0,DX=0.0001

LEAWake: MARK
LEAtrWake: MARK

"SpecM": MARK,FITPOINT=1

PART6:LINE=("BB:Q5",BBQ5M,2*UML1,"BB:Q6",4*UML2,"LA:SC1",UML2,"LA:Q1",2*UML3,&
        "LA:Q2",UML4,LEAWALL,UML5,"LE:GV1",LED1A,"LE:BPM1",LED1B,"LE:YAG1",LED1C,&
        "LE:Q1",LED2A,"LE:SC1",LED2B,"LE:DCCT1",LED2C,"LE:Q2",LED3A,"LE:SC2",LED3B,&
        "LE:GV2",LED3C,"LE:LASER",LED3D,&        
        "LE:Q3",LED4A,"LE:SC3",LED4B,"LE:BPM2",LED4C,"LE:YAG2",LED4D,4*DUTT,DUTC)

DUTtoDIAG:LINE=(LEAWake,LEAtrWake,4*DUTT,LED5A,"LE:BPM3",LED5B,"LE:YAG3",LED5C,"LE:SC4",LED5D,"LE:Q4",LED6A,&
                 "LE:GV3",LED6B,"LE:SC5",LED6C,"LE:Q5",LED7A,"LE:DCCT2",LED7B,&
                 "LE:SC6",LED7C,"LE:Q6",&
                  LED8A,"LE:Q7",LED9A,"LE:SC7",LED9B,"LE:BPM4",LED9C)

DUTtoDUMP:LINE=(DUTtoDIAG,"SpecM",DMAG,10*LED10A,"LE:YAG4")


! beamline from the device under the test location to the beginning of TESSA 
DUTtoTESSA:LINE=(DUTtoDIAG,DMAG,LED10A,"LE:YAG4",LED11,TESSA_CHICANE, &
                  LED12A,"LE:BPM5",LED12B,"LE:YAG4",LED12C,"LE:Q8",LED13)
!pre-buncher beamline
PREBUNCHER:LINE=(TE_PBU,TED1A,PREBUNCHER_CHICANE,TED1B,"TE:Q1",TED2,"TE:Q2",TED3)

! beamline from the device under the test location to the beginning of TESSA undulators

! beamline from the device under the test location to the beginning of TESSA undulators

!THESEUS 
 
"TSU1": CWIGGLER,b_max=0.9459,helical=1,l=0.928,periods=29, Helical=1,SINUSOIDAL=1
"TSU2": CWIGGLER,b_max=0.9459,helical=1,l=0.928,periods=29, Helical=1,SINUSOIDAL=1
"TSU3": CWIGGLER,b_max=0.9459,helical=1,l=0.928,periods=29, Helical=1,SINUSOIDAL=1
"TSU4": CWIGGLER,b_max=0.9459,helical=1,l=0.928,periods=29, Helical=1,SINUSOIDAL=1

"TSU1:Q1": QUAD, L=0.03038, K1=185.4
"TSU1:Q2": QUAD, L=0.03038, K1=-185.4
"TSU2:Q1": QUAD, L=0.03038, K1=185.4
"TSU2:Q2": QUAD, L=0.03038, K1=-185.4
"TSU3:Q1": QUAD, L=0.03038, K1=185.4
"TSU3:Q2": QUAD, L=0.03038, K1=-185.4

"TSU1:B": RBEN, L=0.02629, ANGLE=0.00631
"TSU2:B": RBEN, L=0.02629, ANGLE=0.00631
"TSU3:B": RBEN, L=0.02629, ANGLE=0.00631

"TSU1:D1": LSCDRIFT,LSC=1,BINS=1024, L=0.047508
"TSU1:D2": LSCDRIFT,LSC=1,BINS=1024, L=0.015955
"TSU1:D3": LSCDRIFT,LSC=1,BINS=1024, L=0.033375
"TSU1:D4": LSCDRIFT,LSC=1,BINS=1024, L=0.047508
"TSU2:D1": LSCDRIFT,LSC=1,BINS=1024, L=0.047508
"TSU2:D2": LSCDRIFT,LSC=1,BINS=1024, L=0.015955
"TSU2:D3": LSCDRIFT,LSC=1,BINS=1024, L=0.033375
"TSU2:D4": LSCDRIFT,LSC=1,BINS=1024, L=0.047508
"TSU3:D1": LSCDRIFT,LSC=1,BINS=1024, L=0.047508
"TSU3:D2": LSCDRIFT,LSC=1,BINS=1024, L=0.015955
"TSU3:D3": LSCDRIFT,LSC=1,BINS=1024, L=0.033375
"TSU3:D4": LSCDRIFT,LSC=1,BINS=1024, L=0.047508

TESSAUND1: LINE=("TSU1","TSU1:D1","TSU1:Q1","TSU1:D2","TSU1:B","TSU1:D3","TSU1:Q2","TSU1:D4")
TESSAUND2: LINE=("TSU2","TSU2:D1","TSU2:Q1","TSU2:D2","TSU2:B","TSU2:D3","TSU2:Q2","TSU2:D4")
TESSAUND3: LINE=("TSU3","TSU3:D1","TSU3:Q1","TSU3:D2","TSU3:B","TSU3:D3","TSU3:Q2","TSU3:D4")
TESSAUND4: LINE=("TSU4")
TESSAUNDS: LINE=(TESSAUND1,TESSAUND2,TESSAUND3,TESSAUND4)


"TESSASPEC:D1": LSCDRIFT,LSC=1,BINS=1024,l=0.2
"TESSASPEC:D2": LSCDRIFT,LSC=1,BINS=1024,l=0.7
"TESSASPEC:D3": LSCDRIFT,LSC=1,BINS=1024,l=0.25
"TESSASPEC:D4": LSCDRIFT,LSC=1,BINS=1024,l=0.15
"TESSASPEC:D5": LSCDRIFT,LSC=1,BINS=1024,l=0.15
"TESSASPEC:D6": LSCDRIFT,LSC=1,BINS=1024,l=0.1
"TESSASPEC:D7": LSCDRIFT,LSC=1,BINS=1024,l=0.4
"TESSASPEC:D8": LSCDRIFT,LSC=1,BINS=1024,l=1.646
"TESSASPEC:D9": LSCDRIFT,LSC=1,BINS=1024,l=2.22

"TESSASPEC:SCR": MARK

"TESSASPEC:Q1": QUAD,k1=-23.93,l=0.104
"TESSASPEC:Q2": QUAD,k1=18.969,l=0.104
"TESSASPEC:Q3": QUAD,k1=-14.825,l=0.104
"TESSASPEC:Q4": QUAD,k1=-9.042,l=0.104
"TESSASPEC:Q5": QUAD,k1=11.295,l=0.104

"TESSASPEC:S1": SBEN,angle=-0.1,l=0.25,TILT=-1.57084

"TESSASPEC:RF": RFDF,l=1.2, PHASE=0,VOLTAGE=10e6, TILT=-1.5708, frequency=2.856e9,

::TESSASPEC0: LINE=("TESSASPEC:D1","TESSASPEC:Q1","TESSASPEC:D2","TESSASPEC:Q2","TESSASPEC:D3","TESSASPEC:S1","TESSASPEC:D4","TESSASPEC:Q3","TESSASPEC:D5")
!TESSASPEC: LINE=("TESSASPEC:D1","TESSASPEC:Q1","TESSASPEC:D2","TESSASPEC:Q2","TESSASPEC:D5","TESSASPEC:RF","TESSASPEC:D5","TESSASPEC:S1","TESSASPEC:D4")
TESSASPEC: LINE=("TESSASPEC:D1","TESSASPEC:Q1","TESSASPEC:D2","TESSASPEC:Q2","TESSASPEC:D3","TESSASPEC:Q3","TESSASPEC:D4","TESSASPEC:RF","TESSASPEC:D5","TESSASPEC:S1","TESSASPEC:D6","TESSASPEC:Q4","TESSASPEC:D7","TESSASPEC:Q5","TESSASPEC:D8","TESSASPEC:SCR","TESSASPEC:D9")



!PBTOBBM2: line=(PART2A,M1,PART2B,PART3,PART4,PART5)
PBTODUT:LINE=(PART2A,M1,PART2B,PART3,PART4,PART5,PART6)
!PBtoBISO: line=(PART2A,PART2B,PART3A,PTBB2ItoBISO)
!PBtoBFP: line=(PBtoBISO,LB4,QB2,LB3,BBM,LB2,QB1,LB1)
!PBToDIAG: line=(PBTODUT,DUTtoDIAG)
!PBToDump: line=(PBTODUT,DUTtoDUMP)
LTODUT: line=(LPB,PBTODUT)
LTODUMP: line=(LTODUT,LEAB,DUTToDump)

"LTP:Q1": QUAD,L=0.3061,K1=-0.9401279170771953
"LTP:Q2": QUAD,L=0.3061,K1=3.625089380699915
"LTP:Q3": QUAD,L=0.3061,K1=-3.821310885955497
"LTP:Q4": QUAD,L=0.3061,K1=4.906551332097812
"LTP:Q5": QUAD,L=0.1491,K1=-6.86771142316119
"LTP:B1": SBEND, L=0.4, ANGLE=-0.2, E1=-0.1, E2=-0.1, HGAP=0.02, FINT=0.5
LTPL6: LSCDRIFT,LSC=1,BINS=1024, L=0.70942
LTPL5: LSCDRIFT,LSC=1,BINS=1024, L=0.62634
LTPL4: LSCDRIFT,LSC=1,BINS=1024, L=0.62634
LTPL3: LSCDRIFT,LSC=1,BINS=1024, L=0.62634
LTPL3A: LSCDRIFT,LSC=1,BINS=1024, L=0.42535
LTPL3B: LSCDRIFT,LSC=1,BINS=1024, L=0.20099
LTPL2A: LSCDRIFT,LSC=1,BINS=1024, L=0.3317
LTPL2B: LSCDRIFT,LSC=1,BINS=1024, L=0.496950000000000
LTPL1: LSCDRIFT,LSC=1,BINS=1024, L=2.904756
LTPL1A: LSCDRIFT,LSC=1,BINS=1024, L=1.345630000000000
LTPL1B: LSCDRIFT,LSC=1,BINS=1024, L=0.7262
LTPL1D: LSCDRIFT,LSC=1,BINS=1024, L=0.677476
"LTP:PV1": VMON
"LTP:PV2": VMON
"LTP:PV3": VMON
"LTP:PH1": HMON
"LTP:PH2": HMON
"LTP:PH3": HMON
LTPLMQ1: LSCDRIFT,LSC=1,BINS=1024,L=0.26603
LTPLQ5C: LSCDRIFT,LSC=1,BINS=1024,L=0.19867
"LTP:V1": Mark
"LTP:V2": Mark
"LTP:H1": Mark
"LTP:H2": Mark
"LTP:FL2": MARK
"LTP:FL1": MARK
"LTP:SP": SBEND, L=0.4, ANGLE=0.2, E1=0.2, E2=0.0, HGAP=0.01, FINT=0.5

LTP2FL2: LINE=("LTP:H3",LTPL7,"LTP:B1",LTPL6,"LTP:PV3",LTPLMQ1,"LTP:Q5",LTPLQ5C,"LTP:V2",&
    LTPL5,"LTP:PH3",LTPLMQ,"LTP:Q4",LTPLQC,"LTP:H2",LTPL4,&
    "LTP:PV2",LTPLMQ,"LTP:Q3",LTPLQC,"LTP:V1",LTPL3A,"LTP:FL2")
LTP2FL1:  LINE=(LTP2FL2,LTPL3B,"LTP:PH2",LTPLMQ,"LTP:Q2",LTPLQC1,"LTP:H1",&
    LTPL2A,LTPL2B,"LTP:Q1",LTPL1A,"LTP:FL1")
LTP2: LINE=(LTP2FL1,LTPL1B,"LTP:PH1",LTPL1C,"LTP:PV1",LTPL1D,"LTP:SP")
LTP: LINE=(LTP1,LTP2)
L3FS5ToLTPFL1: line=(L3FS5ToL5O,LTP1,LTP2FL1)
L3FS5ToPAR: line=(L3FS5ToL5O,LTP)

w0: watch,filename="%s.w0",mode="param"
!RFBLM: RFCW,L="86e-12 8 *",VOLT=165e6,PHASE=0,freq=2856e6,change_p0=1,n_kicks=0,cell_length=1e-12,&
!        zwakefile="Sz_1um_200um.sdds",tcolumn="t",wzcolumn="W",interpolate=1
!BLMeas: line=(q,w0,RFBLM,LTP2FL1)

RG2toPBC1: line=(RG2ToL3FS5,L3FS5ToL4I,L4,L5,PB1)
L1OtoPBC1: line=(L1OtoL3FS5,L3FS5ToL4I,L4,L5,PB1)
RG2toPAR: line=(RG2ToL3FS5,L3FS5ToL4I,L4,L5,LTP)
L1OtoPAR: line=(L1OtoL3FS5,L3FS5ToL4I,L4,L5,LTP)
RG2toLTPEA: line=(RG2ToL3FS5,L3FS5ToL4I,L4,L5,LTP1,LTP2FL1)
L1OtoUND: line=(LToDump)
WExit: watch, filename="%s.w0"
TESSA:LINE=(PREBUNCHER,TESSAUNDS)
LTOMATCH: LINE=(LTODUT,DUTTOTESSA,WExit)
TESSAMATCH: LINE=(DUTTOTESSA)

LTOTESSA: line=(LTODUT, DUTTOTESSA,PREBUNCHER,TESSAUNDS)
																			 
